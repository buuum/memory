var Memory;Memory=function(){function a(a,b,c){null==c&&(c={}),this.options={game_class:".game",selected_class:".active",find_class:".find",onLoaded:function(){},onStart:function(){},onClick:function(a,b){},onEnd:function(a,b,c){}},this.options=$.extend(this.options,c),this.cover=a,this.cards=b,this.clicks=0,this.start_time=!1,this.timeout=!1,this.elements_selected=this.options.game_class+" ul li"+this.options.selected_class,this.elements_find=this.options.game_class+" ul li"+this.options.find_class,this.initialize()}return a.prototype.initialize=function(){var a;return a=$("<div />").css("display","none"),$.each(this.cards,function(b){return function(b,c){var d;return d=$("<img >").attr("src",c),a.append(d)}}(this)),a.imagesLoaded().always(function(a){return function(b){return a.options.onLoaded(),a.generateMemory(),a.addEvents()}}(this))},a.prototype.addEvents=function(){return $(this.options.game_class+" ul li").on("click",function(a){return function(b){var c,d;if(b.preventDefault(),c=$(b.target),!c.hasClass(a.name(a.options.selected_class))&&!c.hasClass(a.name(a.options.find_class)))return a.onClick(),$(a.elements_selected).length>1&&(clearTimeout(a.timeout),a.restartSelectedCards()),c.addClass(a.name(a.options.selected_class)),d=a.cards[$("li").index(c)],c.css("background-image","url("+d+")"),$(a.elements_selected).length>1?a.checkPairs():void 0}}(this))},a.prototype.onClick=function(){return this.start_time||this.options.onStart(),this.start_time||(this.start_time=(new Date).getTime()),this.clicks++,this.options.onClick(this.clicks,this.cards.length)},a.prototype.checkPairs=function(){var a,b,c;return a=$(this.elements_selected).eq(0).css("background-image"),b=$(this.elements_selected).eq(1).css("background-image"),a!==b?this.timeout=setTimeout(function(a){return function(){return a.restartSelectedCards()}}(this),1e3):($(this.elements_selected).addClass(this.name(this.options.find_class)),$(this.elements_selected).removeClass(this.name(this.options.selected_class)),this.cards.length===$(this.elements_find).length?(c=(new Date).getTime(),this.options.onEnd((c-this.start_time)/1e3,this.clicks,this.cards.length)):void 0)},a.prototype.restartSelectedCards=function(){return $(this.elements_selected).css("background-image","url("+this.cover+")"),$(this.elements_selected).removeClass(this.name(this.options.selected_class))},a.prototype.generateMemory=function(){var a;return this.cards=this.shuffle(this.cards.concat(this.cards)),a=$("<ul />"),$.each(this.cards,function(b){return function(c,d){var e;return e=$("<li />"),e.css("background-image","url("+b.cover+")"),a.append(e)}}(this)),$(""+this.options.game_class).append(a)},a.prototype.shuffle=function(a){var b,c,d;for(b=a.length,d=void 0,c=void 0;0!==b;)c=Math.floor(Math.random()*b),b-=1,d=a[b],a[b]=a[c],a[c]=d;return a},a.prototype.name=function(a){return a.substr(1)},a}();